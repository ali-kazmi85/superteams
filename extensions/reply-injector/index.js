!function(){function e(e,t,o){var a=new RegExp("([?&])"+t+"=.*?(&|$)","i"),r=-1!==e.indexOf("?")?"&":"?";return e.match(a)?e.replace(a,"$1"+t+"="+o+"$2"):e+r+t+"="+o}function t(){var t=document.querySelectorAll('[data-tid="threadBodyMedia"]');t&&t.forEach((function(t){var a=t.querySelector(".top-row-text-container");if(t&&a){if(!a.hasAttribute("data-hasquote")){var n=document.createElement("button");n.classList.add("teams-custom-quote-message-button"),Object.assign(n.style,r),a.appendChild(n),a.setAttribute("data-hasquote","true"),n.addEventListener("click",o)}if(!a.hasAttribute("data-hasgoto")){var i=t.querySelector("blockquote[itemtype='http://schema.skype.com/Reply']");i&&i.hasAttribute("itemid")&&(i.addEventListener("click",(function(t){var o=t.currentTarget.getAttribute("itemid"),a=e(window.location.href,"messageId",""),r=e(window.location.href,"messageId",o);window.location.href=a,window.location.href=r})),a.setAttribute("data-hasgoto","true"))}}}))}function o(t){a();var o=t.target.offsetParent.querySelector('[data-tid="messageBodyContent"]').cloneNode(!0),r=o.querySelector("blockquote[itemtype='http://schema.skype.com/Reply']");r&&r.remove();var n,i,s,c,d=o.innerText,u=t.target.offsetParent.querySelector('[data-tid="threadBodyDisplayName"]').innerText,l=t.target.offsetParent.offsetParent.offsetParent.querySelector('[data-tid="threadBodyMedia"]').id.substr(1),m=(e(window.location.href,"messageId",l),n=t.target.offsetParent.offsetParent.offsetParent.offsetParent.offsetParent.dataset.scrollId,null!=(i=/(\{){0,1}[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}(\}){0,1}/.exec(n))?n.substr(0,i.index)+i[0]:null),p=(s='\n        <blockquote itemscope itemtype="http://schema.skype.com/Reply" itemid="'.concat(l,'">\n          <strong itemprop="mri" itemid="').concat(m,'">').concat(u,'</strong>\n          <span itemprop="time" itemid="').concat(l,'"></span>\n          <p itemprop="preview">\n            ').concat(d,"\n          </p>\n        </blockquote>\n      "),(c=document.createElement("div")).innerHTML=s.trim(),c.firstChild);p.addEventListener("click",(function(){a()}));var y=document.querySelector(".cke_wysiwyg_div");document.querySelector(".ts-text-watermark").style.display="none",y.insertBefore(p,y.firstChild),document.querySelector(".cke_contents").style.height=p.offsetHeight+40+"px"}function a(){var e=document.querySelector(".cke_wysiwyg_div").querySelector("blockquote");if(e&&e.remove(),!document.querySelector(".cke_wysiwyg_div").innerText.trim()){var t=document.querySelector(".cke_wysiwyg_div"),o=document.querySelector(".cke_contents"),a=document.querySelector(".ts-text-watermark");t.innerHTML="<div> <br> </div>",a.style.display="block",o.style.height="33px"}}var r={margin:"0 0 0 2em",padding:"0","border-radius":"2px",outline:"none",border:"none",cursor:"pointer",background:"transparent"};setTimeout((function(){var e,o,a,r=document;e=document.getElementsByTagName("head")[0],o=document.createElement("style"),a=document.createTextNode("\n      .teams-custom-quote-message-button { height: 16px; width: 16px; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAFo9M/3AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAGlSURBVChTnZOxSwJRHMfvpogwaAgaogNFCM+93LolG9qabhCCECeHJhe3hrZaHHNwTHD1D7ghx5YjBIMLRUIHl/OSjvO9vr93Ty/xiugDX97v+/v93k/fe5yyhHOeoiV0QIV4NpsNXSaTQQc/CB2A2ZVhDKheQE/SKkqhUGCqqjKENOdQJBE80jqdTgORIJDMQ01pI5C8TKVSYsRC9XodaX5EdQHMfqlUomQT2oZuarUa63Q60dHiQOOGDP8AY8yT4TqDweAzn6dD8FOZinAch866PIGu6ywIgleqCXzff8MiiosbI00mExdryHw+78qfUKFjbHpPJBLkDdmCLZw/y1AAfwV1pY0HDXcyXAWFE5og7d/BpvPxeDyrVCoM8frD/gSazX6/76fTaXEDyWSSNxoN1mq1eK/Xo2Ev0DW0Ge74BpJOuVxe3vNvMgyDjUajD+w5g49AQqPHKRaL4h1yuRz3PI+5rsuGwyG3LItVq1WuaZoYZJom/SsLos8nAok9vJndbrdj7wC5Lejetm0aSD0PsrQKCjuQLm0sqN9CM2n/i6J8AYR+NYM1RnyMAAAAAElFTkSuQmCC') !important; background-size: 16px 16px !important; }\n      .teams-custom-quote-message-button:hover { color: #a2c0f5 !important; }\n      .ts-message-thread-body .message-body-top-row .top-row-text-container { justify-content: space-between; }\n      blockquote[itemtype='http://schema.skype.com/Reply'] { cursor: pointer; }\n      .cke_wysiwyg_div blockquote[itemtype='http://schema.skype.com/Reply'] { cursor: default; pointer-events: none; }\n      .cke_wysiwyg_div blockquote[itemtype='http://schema.skype.com/Reply']:before { content: 'x'; font-weight: bold; pointer-events: all; cursor: pointer; position: absolute; right: 20px; top: 10px; }\n    "),o.type="text/css",o.styleSheet?o.styleSheet.cssText=a.nodeValue:o.appendChild(a),e.appendChild(o),t(),function(e){new MutationObserver((function(e,o){if(e)for(var a=0;a<e.length;a++)if(e[a].addedNodes)for(var r=0;r<e[a].addedNodes.length;r++)e[a].addedNodes[r].classList&&e[a].addedNodes[r].classList.contains("thread-body")&&t()})).observe(e,{attributes:!1,childList:!0,subtree:!0,characterData:!1,characterDataOldValue:!1,attributeOldValue:!1}),console.log("DOM Mutation Observer init")}(r)}),4e3)}();